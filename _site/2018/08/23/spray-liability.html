<!DOCTYPE HTML>
<!--
Prologue by HTML5 UP
html5up.net | @ajlkn
Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
Jekyll integration by Chris Bobbe | chrisbobbe.github.io
-->
<html><head><!-- Robots -->
  <meta name="robots" content="index, follow" /><link rel="canonical" href="http://localhost:4000/2018/08/23/spray-liability.html" /><!-- Title, description, author --><title>Spray Liability | Albert Warner - Online Portfolio</title>
  <meta name="description" content="Welcome to my Third year Project blog.  I joined the Web Development team and this is my Journey through this project." />
  <meta name="author" content="Albert Warner" />
  
  <!-- Open Graph -->
  <meta property="og:title" content="Spray Liability | Albert Warner - Online Portfolio" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://localhost:4000/assets/images/albert.JPG" />
  <meta property="og:url" content="http://localhost:4000/2018/08/23/spray-liability.html" />
  <meta property="og:site_name" content="Albert Warner" />
  <meta property="og:description" content="Welcome to my Third year Project blog.  I joined the Web Development team and this is my Journey through this project." />
  
  <!-- Styles -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js" defer></script><![endif]-->
  <link rel="stylesheet" href="/assets/css/main.css" />
  <!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
  <!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js" defer></script>
  <script src="/assets/js/jquery.scrolly.min.js" defer></script>
  <script src="/assets/js/jquery.scrollzer.min.js" defer></script>
  <script src="/assets/js/skel.min.js" defer></script>
  <script src="/assets/js/util.js" defer></script>
  <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js" defer></script><![endif]-->
  <script src="/assets/js/main.js" defer></script>

</head><body><!-- Header -->
<div id="header">
  <div class="top"><!-- Logo -->
<div id="logo">
  <a href="http://localhost:4000/" id="home-link">
    <span class="image avatar48"><img src="/assets/images/albert.JPG" alt="Avatar of Albert Warner" /></span>
    <h1 id="title">Albert Warner</h1>
    <p>Online Portfolio</p>
  </a>
</div><!-- Nav -->
<nav id="nav">
  <ul><li><a href="http://localhost:4000/" id="my-home-page-link">
            <span class="icon fa-home">My Home Page</span>
          </a></li><li><a href="http://localhost:4000/blog.html" id="project-1-2-link">
            <span class="icon fa-pencil">Project 1 & 2</span>
          </a></li></ul>
</nav></div>
  <div class="bottom"><!-- Social Icons -->
<ul class="icons"><li><a href="https://www.linkedin.com/in/albert-warner-120a6074/" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li><li><a href="http://github.com/AlbertWarner" class="icon fa-github"><span class="label">GitHub</span></a></li><li><a href="mailto:warnaa1@student.op.ac.nz" class="icon fa-envelope"><span class="label">Email</span></a></li></ul>
</div>
</div>
<!-- Main -->
<div id="main">
	<!-- Post -->
	<article class="shade-two">
	  <div class="container">
			<header>
				<h2>Spray Liability</h2>
				<p>23 August 2018</p>
			</header><p>I was hoping the form would go smooth and be an ok build, but the Spray liability claim form was hugely different to the others. I copied the sections that were common to the aircraft but the following components I had to create:</p>

<h3>Components created </h3>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span><span class="o">.</span> <span class="s1">'incident.php'</span><span class="p">)</span> <span class="cp">?&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span><span class="o">.</span> <span class="s1">'farmowner.php'</span><span class="p">)</span> <span class="cp">?&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span><span class="o">.</span> <span class="s1">'farmManager.php'</span><span class="p">)</span> <span class="cp">?&gt;</span>
        <span class="c">&lt;!--Weather Details--&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class=</span><span class="s">"text-center"</span><span class="nt">&gt;</span>Weather details<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formComponentUrl</span> <span class="o">.</span> <span class="s1">'weatherDetails.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="c">&lt;!-- Circumstances of the incident Section--&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"anchor"</span> <span class="na">id=</span><span class="s">"anch5"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Circumstances of the incident<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span><span class="o">.</span> <span class="s1">'circumstances.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="c">&lt;!-- Property Damage Section--&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"anchor"</span> <span class="na">id=</span><span class="s">"anch6"</span><span class="nt">&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Property damage<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'propertyDamage.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Hold Liability Letter<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'holdLiability.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Environmental Damage<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'environmental.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Personal Injury<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'personalInjury.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Statement to Owner<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'statementOwner.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Statement to CAA<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'statementCAA.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Statement to Police<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'statementPolice.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
        <span class="nt">&lt;h2</span> <span class="na">class= </span><span class="s">"text-center"</span><span class="nt">&gt;</span>Statement to TAIC<span class="nt">&lt;/h2&gt;</span>
        <span class="cp">&lt;?php</span> <span class="k">include_once</span> <span class="p">(</span><span class="nv">$formSprayLiabilityUrl</span> <span class="o">.</span> <span class="s1">'statementTAIC.php'</span><span class="p">);</span><span class="cp">?&gt;</span>
 
</code></pre></div></div>

<p>After creating each component, I had to create the queries to display their data.</p>

<h3>Queries Created </h3>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">//comments details - spray Liab</span>
                                            <span class="nv">$generalQuery35</span><span class="o">=</span><span class="s2">"SELECT * FROM comments WHERE incidentID =</span><span class="nv">$incidentID</span><span class="s2"> AND commentType = 'Hold_Liability_Letter'"</span><span class="p">;</span>
                                            <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$pdo</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$generalQuery35</span><span class="p">);</span>
                                            <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>  
                                            <span class="nv">$generalResult35</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">fetchAll</span><span class="p">();</span>
                                            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$generalResult35</span><span class="p">)){</span>
                                            <span class="nv">$holdID</span> <span class="o">=</span> <span class="nv">$generalResult35</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'id'</span><span class="p">];</span>
                                            <span class="nv">$holdComment</span> <span class="o">=</span> <span class="nv">$generalResult35</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">'comment'</span><span class="p">];</span> 
                                            <span class="p">}}</span>

</code></pre></div></div>

<p>I really think I could have done the queries better, for example, I could have added an associative table from incident to comments and this would have given me the ability to create one query to populate an array and get the information out of the array. Instead, I created a query for each individual component. I did a test with a single query, in the arguments of the query I added “&amp;&amp; commentType = ‘environmental’” etc but the array printed out was filled with large amounts of duplications.</p>

<h3>Update Function </h3>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">function</span>  <span class="nf">updateHLComment</span><span class="p">(</span><span class="nv">$pdo</span><span class="p">,</span><span class="nv">$comment</span><span class="p">)</span>
    <span class="p">{</span>           
           <span class="nv">$updateQuery</span><span class="o">=</span><span class="s2">"UPDATE comments SET  
            comment = :comment
            WHERE id = :id AND  commentType = 'Hold_Liability_Letter'"</span><span class="p">;</span> 
           <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$pdo</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$updateQuery</span><span class="p">);</span>
           <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">(</span><span class="nv">$comment</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>With the un-neat way of doing the comments, which meant the function to update the DB were going to be un-neat as well, instead of creating 1 update function, I had to create 8 functions. I feel this is very un-neat and needs fixing but for now it is working, and it can be changed when code is being cleaned up.</p>

<p>The form is working, and no errors are showing. More Testing will be done at the end.</p>
</div>
	</article>
</div><!-- Footer -->
<div id="footer">
  
  <!-- Copyright -->
  <ul class="copyright">
    
      <li>&copy;Albert Warner. All rights reserved.</li>
    
    <li>Git Hub Link: <a href="http://github.com/AlbertWarner">Albert Warner</a></li>
    <li>LinkedIn: <a href="https://www.linkedin.com/in/albert-warner-120a6074/">Albert Warner</a></li>
  </ul>
  
</div></body>
</html>